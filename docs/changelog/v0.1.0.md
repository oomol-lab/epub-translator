# Release v0.1.0

We're excited to announce the release of EPUB Translator v0.1.0! This release represents a major milestone with significant improvements to translation quality, performance, and user experience.

## ðŸŽ‰ Highlights

- **Strict Translation Alignment**: Enhanced correction mechanism ensures translations are precisely aligned with XML structure, preventing text loss and misalignment
- **Format Preservation**: Complete preservation of inline formatting tags (bold, italic, etc.) in translated output
- **Progress Tracking**: Monitor translation progress in real-time with the new `on_progress` callback
- **Smart Caching**: Resume failed translations from where you left off with built-in cache support
- **Complete Translation**: Now translates table of contents and metadata in addition to chapter content

## âœ¨ Features

### Strict Translation Alignment
- **Enhanced correction mechanism** ensures translations are precisely fitted into XML structure
- **Prevents text loss** that could occur during translation process (addresses content omission issues)
- **Eliminates misalignment** between source and translated text
- Strict validation loop continues until all content is properly translated and positioned
- Significantly improves translation reliability for complex book structures

### Complete Format Preservation
- **Preserves all inline formatting tags** including `<em>`, `<strong>`, `<i>`, `<b>`, and other style elements
- Maintains formatting within sentences and paragraphs
- Translated text inherits the exact same XML structure as the source
- No more lost bold or italic emphasis in translations
- Formatting applied through both tags and CSS styles is fully preserved

### Progress Monitoring
- Added `on_progress` callback parameter to `translate()` function
- Real-time progress updates during translation (0.0 to 1.0 scale)
- Weighted progress calculation: TOC (3%), metadata (2%), chapters (95%)
- Perfect for building progress bars and tracking translation status

### Caching System
- New `cache_path` parameter in `LLM` class for persistent caching
- Automatically resumes translation from last successful state after failures
- Reduces API costs by avoiding re-translation of identical content
- Cache directory created automatically if it doesn't exist

### Mathematical Expression Handling
- Fixed crash issues when encountering MathML elements in EPUB files
- Mathematical expressions are now safely skipped during translation (preserved as-is)
- No longer causes translation process to fail when books contain mathematical notation
- MathML content remains in its original form without modification

### Metadata and TOC Translation
- Translates EPUB metadata fields (title, description, creator, publisher, etc.)
- Smart field filtering to skip technical metadata (language codes, identifiers, dates)
- Complete table of contents translation with hierarchical structure preservation
- Batch translation for improved efficiency

### Enhanced XML Processing
- Complete rewrite of XML translation engine for improved reliability
- Better handling of fragmented text elements across XML tags
- Automatic deduplication of element IDs to prevent conflicts
- Improved text segmentation with token-aware splitting
- Preserves inline formatting elements (bold, italic, etc.) within translated text
- Strict alignment ensures translated content matches source structure exactly

## ðŸ”§ Improvements

### Translation Quality
- **Strict alignment mechanism** prevents text loss and ensures accurate positioning
- **Complete format preservation** maintains all inline styling (bold, italic, etc.)
- Smarter text grouping based on token count limits
- Better preservation of XML structure and formatting
- Improved handling of empty space between tags
- More accurate paragraph splitting and reassembly
- Enhanced validation loop ensures all content is properly translated

### Performance
- More efficient batch processing of translation requests
- Optimized token counting includes XML tags for better accuracy
- Progressive locking mechanism for concurrent operations
- Reduced memory footprint for large EPUB files

### Developer Experience
- Cleaner API with better parameter naming
- Comprehensive inline documentation
- Improved error messages and debugging information
- Better code organization with clear separation of concerns

## ðŸ› Bug Fixes

- **Fixed critical crash when encountering MathML elements** - translation no longer fails on books with mathematical notation
- **Resolved text loss and misalignment issues** - enhanced validation ensures all source content is properly translated (https://github.com/oomol-lab/epub-translator/issues/25)
- **Fixed loss of inline formatting** - bold, italic, and other style tags are now preserved in translations (https://github.com/oomol-lab/epub-translator/issues/32)
- Fixed incorrect positioning when appending translated text
- Resolved paragraph splitting issues in complex XML structures
- Fixed extra whitespace insertion between XML tags
- Corrected body element extraction from EPUB chapters
- Improved handling of edge cases in text segmentation

## ðŸ”¨ Refactoring

- Renamed `xml_translator` module for better clarity (removed `xml_` prefix)
- Removed legacy translation code in favor of new implementation
- Reorganized module structure for better maintainability
- Cleaned up unused dependencies and dead code
- Updated Jinja2 templates for English prompts

## âš ï¸ Breaking Changes

### Python Version Requirements
- **Minimum Python version increased from 3.10 to 3.11**
- **Maximum Python version increased from 3.12 to 3.13**
- Users on Python 3.10 must upgrade to Python 3.11+ to use this version

### API Changes
- Removed deprecated translation modules and functions
- Some internal APIs have been refactored (public API remains stable)

## ðŸ“¦ Dependencies

- Updated `resource-segmentation` to `>=0.0.7,<0.1.0`
- Added `tiktoken` for improved token counting
- Added `jinja2` for template-based prompt generation
- Maintained compatibility with `openai>=2.14.0,<3.0.0`

## ðŸ™ Acknowledgments

This release includes contributions from automated AI-assisted development, code reviews, and extensive testing. Thank you to everyone who provided feedback and reported issues!

## ðŸ“ What's Next

Looking ahead to v0.2.0, we're planning:
- Additional language model provider support
- Customizable translation styles and terminology
- Improved handling of complex EPUB structures
- Performance optimizations for very large books
